{"version":3,"sources":["mvc/ui/ui-tabs.js"],"names":["View","Backbone","extend","initialize","options","this","collection","Collection","model","Model","onchange","visible","set","setElement","$","_template","$el","self","render","listenTo","_add","_remove","_change","$content","_reset","on","id","get","length","first","children","addClass","$nav","size","current","show","hide","add","del","remove","delAll","reset","showTab","hideTab","tab_model","attributes","append","tooltip","title","placement","e","preventDefault","empty","_template_tab","$href","$tmpl","attr","find","icon"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-tabs.js","sourcesContent":["/**\n *  Renders tabs e.g. used in the charts editor, behaves similar to repeat and section rendering\n */\nimport Utils from \"utils/utils\";\nvar View = Backbone.View.extend({\n    initialize: function(options) {\n        var self = this;\n        this.collection = new Backbone.Collection();\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                onchange: null,\n                visible: true\n            }).set(options);\n        this.setElement($(this._template()));\n        this.$nav = this.$(\".tab-navigation\");\n        this.$content = this.$(\".tab-content\");\n        this.$el.on(\"click\", () => {\n            $(\".tooltip\").hide();\n        });\n        this.render();\n        this.listenTo(this.model, \"change\", this.render, this);\n        this.listenTo(this.collection, \"add\", this._add, this);\n        this.listenTo(this.collection, \"remove\", this._remove, this);\n        this.listenTo(this.collection, \"change\", this._change, this);\n        this.listenTo(this.collection, \"reset\", this._reset, this);\n        this.listenTo(this.collection, \"add remove reset\", this.render, this);\n    },\n\n    render: function() {\n        var id = this.model.get(\"current\");\n        id = this.$(`#${id}`).length > 0 ? id : this.first();\n        if (id) {\n            this.$nav.children().removeClass(\"active\");\n            this.$content.children().removeClass(\"active\");\n            this.$(`#tab-${id}`).addClass(\"active\");\n            this.$(`#${id}`).addClass(\"active\");\n        }\n        this.$el[this.model.get(\"visible\") ? \"fadeIn\" : \"fadeOut\"](\"fast\");\n        this.$nav[this.size() > 1 ? \"show\" : \"hide\"]();\n    },\n\n    /** Returns tab id for currently shown tab */\n    current: function() {\n        return this.model.get(\"current\");\n    },\n\n    /** Show tab view and highlight a tab by id */\n    show: function(id) {\n        if (id) {\n            this.model.set({ current: id, visible: true });\n            this.model.get(\"onchange\") && this.model.get(\"onchange\")(id);\n        }\n    },\n\n    /** Hide tab view */\n    hide: function() {\n        this.model.set(\"visible\", false);\n    },\n\n    /** Returns first tab */\n    first: function() {\n        var model = this.collection.first();\n        return model && model.id;\n    },\n\n    /** Returns current number of tabs */\n    size: function() {\n        return this.collection.length;\n    },\n\n    /** Adds a new tab */\n    add: function(options) {\n        this.collection.add(options);\n    },\n\n    /** Delete tab */\n    del: function(id) {\n        this.collection.remove(id);\n    },\n\n    /** Delete all tabs */\n    delAll: function() {\n        this.collection.reset();\n    },\n\n    /** Show tab */\n    showTab: function(id) {\n        this.collection.get(id).set(\"hidden\", false);\n    },\n\n    /** Hide tab */\n    hideTab: function(id) {\n        this.collection.get(id).set(\"hidden\", true);\n    },\n\n    /** Adds a new tab */\n    _add: function(tab_model) {\n        var self = this;\n        var options = tab_model.attributes;\n        this.$content.append(\n            $(\"<div/>\")\n                .attr(\"id\", options.id)\n                .addClass(\"tab-pane\")\n                .append(options.$el)\n        );\n        this.$nav.append(\n            $(this._template_tab(options))\n                .show()\n                .tooltip({\n                    title: options.tooltip,\n                    placement: \"bottom\",\n                    container: self.$el\n                })\n                .on(\"click\", e => {\n                    e.preventDefault();\n                    self.show(options.id);\n                })\n        );\n        if (this.size() == 1) {\n            this.show(options.id);\n        }\n    },\n\n    /** Delete tab */\n    _remove: function(tab_model) {\n        this.$(`#tab-${tab_model.id}`).remove();\n        this.$(`#${tab_model.id}`).remove();\n    },\n\n    /** Reset collection */\n    _reset: function() {\n        this.$nav.empty();\n        this.$content.empty();\n    },\n\n    /** Change tab */\n    _change: function(tab_model) {\n        this.$(`#tab-${tab_model.id}`)[tab_model.get(\"hidden\") ? \"hide\" : \"show\"]();\n    },\n\n    /** Main template */\n    _template: function() {\n        return $(\"<div/>\")\n            .addClass(\"ui-tabs tabbable tabs-left\")\n            .append($(\"<ul/>\").addClass(\"tab-navigation nav nav-tabs\"))\n            .append($(\"<div/>\").addClass(\"tab-content\"));\n    },\n\n    /** Tab template */\n    _template_tab: function(options) {\n        var $tmpl = $(\"<li/>\")\n            .addClass(\"tab-element\")\n            .attr(\"id\", `tab-${options.id}`)\n            .append($(\"<a/>\").attr(\"id\", `tab-title-link-${options.id}`));\n        var $href = $tmpl.find(\"a\");\n        options.icon &&\n            $href.append(\n                $(\"<i/>\")\n                    .addClass(\"tab-icon fa\")\n                    .addClass(options.icon)\n            );\n        $href.append(\n            $(\"<span/>\")\n                .attr(\"id\", `tab-title-text-${options.id}`)\n                .addClass(\"tab-title-text\")\n                .append(options.title)\n        );\n        return $tmpl;\n    }\n});\n\nexport default { View: View };\n"]}