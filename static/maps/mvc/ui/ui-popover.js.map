{"version":3,"sources":["mvc/ui/ui-popover.js"],"names":["View","Backbone","extend","optionsDefault","with_close","title","placement","container","body","initialize","options","this","setElement","_template","defaults","parent","append","el","$","self","uid","$close","$body","is","e","target","has","length","$title","html","$el","removeClass","addClass","css","_get_placement","on","hide","show","off","newTitle","undefined","render","visible","empty","remove","top","left","_get_width","height","$container","container_width","container_height","container_position","indexOf","width","parseInt","_get_height"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-popover.js","sourcesContent":["/**\n * Popover wrapper\n*/\nimport Utils from \"utils/utils\";\nvar View = Backbone.View.extend({\n    optionsDefault: {\n        with_close: true,\n        title: null,\n        placement: \"top\",\n        container: \"body\",\n        body: null\n    },\n\n    initialize: function(options) {\n        this.setElement(this._template());\n        this.uid = Utils.uid();\n        this.options = _.defaults(options || {}, this.optionsDefault);\n        this.options.container.parent().append(this.el);\n        this.$title = this.$(\".popover-title-label\");\n        this.$close = this.$(\".popover-close\");\n        this.$body = this.$(\".popover-content\");\n\n        // add initial content\n        this.options.body && this.append(this.options.body);\n\n        // add event to hide if click is outside of popup and not on container\n        var self = this;\n        $(\"body\").on(`mousedown.${this.uid}`, e => {\n            // the 'is' for buttons that trigger popups\n            // the 'has' for icons within a button that triggers a popup\n            self.visible &&\n                !$(self.options.container).is(e.target) &&\n                !$(self.el).is(e.target) &&\n                $(self.el).has(e.target).length === 0 &&\n                self.hide();\n        });\n    },\n\n    /**\n     * Render popover\n    */\n    render: function() {\n        this.$title.html(this.options.title);\n        this.$el\n            .removeClass()\n            .addClass(\"ui-popover popover fade in\")\n            .addClass(this.options.placement);\n        this.$el.css(this._get_placement(this.options.placement));\n\n        // configure close option\n        var self = this;\n        if (this.options.with_close) {\n            this.$close\n                .on(\"click\", () => {\n                    self.hide();\n                })\n                .show();\n        } else {\n            this.$close.off().hide();\n        }\n    },\n\n    /**\n     * Set the popover title\n     * @params{ String }    newTitle    - New popover title\n    */\n    title: function(newTitle) {\n        if (newTitle !== undefined) {\n            this.options.title = newTitle;\n            this.$title.html(newTitle);\n        }\n    },\n\n    /**\n     * Show popover\n    */\n    show: function() {\n        this.render();\n        this.$el.show();\n        this.visible = true;\n    },\n\n    /**\n     * Hide popover\n    */\n    hide: function() {\n        this.$el.hide();\n        this.visible = false;\n    },\n\n    /**\n     * Append new content to the popover\n     * @params{ Object }  $el - Dom element\n    */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /**\n     * Remove all content\n    */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /**\n     * Remove popover\n    */\n    remove: function() {\n        $(\"body\").off(`mousedown.${this.uid}`);\n        this.$el.remove();\n    },\n\n    /**\n     * Improve popover location/placement\n    */\n    _get_placement: function(placement) {\n        // get popover dimensions\n        var width = this._get_width(this.$el);\n        var height = this.$el.height();\n\n        // get container details\n        var $container = this.options.container;\n        var container_width = this._get_width($container);\n        var container_height = this._get_height($container);\n        var container_position = $container.position();\n\n        // get position\n        var top;\n\n        var left;\n        top = left = 0;\n        if ([\"top\", \"bottom\"].indexOf(placement) != -1) {\n            left = container_position.left - width + (container_width + width) / 2;\n            switch (placement) {\n                case \"top\":\n                    top = container_position.top - height - 5;\n                    break;\n                case \"bottom\":\n                    top = container_position.top + container_height + 5;\n                    break;\n            }\n        } else {\n            top = container_position.top - height + (container_height + height) / 2;\n            switch (placement) {\n                case \"right\":\n                    left = container_position.left + container_width;\n                    break;\n            }\n        }\n        return { top: top, left: left };\n    },\n\n    /**\n     * Returns padding/margin corrected width\n    */\n    _get_width: function($el) {\n        return (\n            $el.width() +\n            parseInt($el.css(\"padding-left\")) +\n            parseInt($el.css(\"margin-left\")) +\n            parseInt($el.css(\"padding-right\")) +\n            parseInt($el.css(\"margin-right\"))\n        );\n    },\n\n    /**\n     * Returns padding corrected height\n    */\n    _get_height: function($el) {\n        return $el.height() + parseInt($el.css(\"padding-top\")) + parseInt($el.css(\"padding-bottom\"));\n    },\n\n    /**\n     * Return the popover template\n    */\n    _template: function(options) {\n        return (\n            '<div class=\"ui-popover popover fade in\">' +\n            '<div class=\"arrow\"/>' +\n            '<div class=\"popover-title\">' +\n            '<div class=\"popover-title-label\"/>' +\n            '<div class=\"popover-close fa fa-times-circle\"/>' +\n            \"</div>\" +\n            '<div class=\"popover-content\"/>' +\n            \"</div>\"\n        );\n    }\n});\n\nexport default {\n    View: View\n};\n"]}