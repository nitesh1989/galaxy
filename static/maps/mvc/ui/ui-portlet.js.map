{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["View","Backbone","extend","visible","initialize","options","self","this","model","Model","id","_utils2","default","uid","cls","title","icon","buttons","body","scrollable","nopadding","onchange_title","_template","$","operations","collapsible","collapsible_button","collapsed","setElement","get","_uiMisc2","ButtonIcon","$title_text","tooltip","$title_icon","$header","onclick","$content","$backdrop","render","html","_","each","$body","$el","hide","removeClass","addClass","off","collapse","expand","on_finish","new_title","$buttons","empty","show","name","item","prop","append","$operations","header","fadeIn","enableButton","disableButton","find","hideOperation","showOperation","callback","on","height","setIcon","disable","enable"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["import Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\nvar View = Backbone.View.extend({\n    visible: false,\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                id: Utils.uid(),\n                cls: \"ui-portlet\",\n                title: \"\",\n                icon: \"\",\n                buttons: null,\n                body: null,\n                scrollable: true,\n                nopadding: false,\n                operations: null,\n                collapsible: false,\n                collapsible_button: false,\n                collapsed: false,\n                onchange_title: null\n            }).set(options);\n        this.setElement(this._template());\n\n        // link all dom elements\n        this.$body = this.$(\".portlet-body\");\n        this.$title_text = this.$(\".portlet-title-text\");\n        this.$title_icon = this.$(\".portlet-title-icon\");\n        this.$header = this.$(\".portlet-header\");\n        this.$content = this.$(\".portlet-content\");\n        this.$backdrop = this.$(\".portlet-backdrop\");\n        this.$buttons = this.$(\".portlet-buttons\");\n        this.$operations = this.$(\".portlet-operations\");\n\n        // add body to component list\n        this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n        // add icon for collapsible option\n        this.collapsible_button = new Ui.ButtonIcon({\n            icon: \"fa-eye\",\n            tooltip: \"Collapse/Expand\",\n            cls: \"ui-button-icon-plain\",\n            onclick: function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            }\n        });\n        this.render();\n    },\n\n    render: function() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el\n            .removeClass()\n            .addClass(options.cls)\n            .attr(\"id\", options.id);\n        this.$header[options.title ? \"show\" : \"hide\"]();\n        this.$title_text.html(options.title);\n        _.each([this.$content, this.$body], $el => {\n            $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n        });\n\n        // render title icon\n        if (options.icon) {\n            this.$title_icon\n                .removeClass()\n                .addClass(\"portlet-title-icon fa\")\n                .addClass(options.icon)\n                .show();\n        } else {\n            this.$title_icon.hide();\n        }\n\n        // make portlet collapsible\n        this.$title_text[options.collapsible ? \"addClass\" : \"removeClass\"](\"no-highlight collapsible\").off();\n        if (options.collapsible) {\n            this.$title_text.on(\"click\", () => {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            });\n            options.collapsed ? this.collapse() : this.expand();\n        }\n\n        // allow title editing\n        this.$title_text.prop(\"disabled\", !options.onchange_title);\n        options.onchange_title &&\n            this.$title_text.make_text_editable({\n                on_finish: function(new_title) {\n                    options.onchange_title(new_title);\n                }\n            });\n\n        // render buttons\n        if (options.buttons) {\n            this.$buttons.empty().show();\n            $.each(this.model.get(\"buttons\"), (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$buttons.append(item.$el);\n            });\n        } else {\n            this.$buttons.hide();\n        }\n\n        // render operations\n        this.$operations.empty;\n        if (options.collapsible_button) {\n            this.$operations.append(this.collapsible_button.$el);\n        }\n        if (options.operations) {\n            $.each(options.operations, (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$operations.append(item.$el);\n            });\n        }\n        return this;\n    },\n\n    /** Append new doms to body */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /** Remove all content */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /** Return header element */\n    header: function() {\n        return this.$header;\n    },\n\n    /** Return body element */\n    body: function() {\n        return this.$body;\n    },\n\n    /** Show portlet */\n    show: function() {\n        this.visible = true;\n        this.$el.fadeIn(\"fast\");\n    },\n\n    /** Hide portlet */\n    hide: function() {\n        this.visible = false;\n        this.$el.hide();\n    },\n\n    /** Enable a particular button */\n    enableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", false);\n    },\n\n    /** Disable a particular button */\n    disableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", true);\n    },\n\n    /** Hide a particular operation */\n    hideOperation: function(id) {\n        this.$operations.find(`#${id}`).hide();\n    },\n\n    /** Show a particular operation */\n    showOperation: function(id) {\n        this.$operations.find(`#${id}`).show();\n    },\n\n    /** Replaces the event callback of an existing operation */\n    setOperation: function(id, callback) {\n        this.$operations\n            .find(`#${id}`)\n            .off(\"click\")\n            .on(\"click\", callback);\n    },\n\n    /** Change title */\n    title: function(new_title) {\n        new_title && this.$title_text.html(new_title);\n        return this.$title_text.html();\n    },\n\n    /** Collapse portlet */\n    collapse: function() {\n        this.collapsed = true;\n        this.$content.height(\"0%\");\n        this.$body.hide();\n        this.collapsible_button.setIcon(\"fa-eye-slash\");\n    },\n\n    /** Expand portlet */\n    expand: function() {\n        this.collapsed = false;\n        this.$content.height(\"100%\");\n        this.$body.fadeIn(\"fast\");\n        this.collapsible_button.setIcon(\"fa-eye\");\n    },\n\n    /** Disable content access */\n    disable: function() {\n        this.$backdrop.show();\n    },\n\n    /** Enable content access */\n    enable: function() {\n        this.$backdrop.hide();\n    },\n\n    _template: function() {\n        return $(\"<div/>\")\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-header\")\n                    .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                    .append(\n                        $(\"<div/>\")\n                            .addClass(\"portlet-title\")\n                            .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                            .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                    )\n            )\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-content\")\n                    .append($(\"<div/>\").addClass(\"portlet-body\"))\n                    .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n            )\n            .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n    }\n});\nexport default {\n    View: View\n};\n"]}