{"version":3,"sources":["mvc/toolshed/util.js"],"names":["searchShed","request","response","that","this","shed_url","base_url","Galaxy","root","$","get","term","tool_shed_url","data","result_list","shedParser","results","each","hits","hit","record","label","repository","name","repo_owner_username","value","id","jsondata","addToQueue","metadata","substr","length","key","repository_id","changeset_revision","Object","localStorage","queued_repos","stringify","queueLength","repositories","JSON","keys","repo_queue"],"mappings":"4HA0CQA,WA1CS,SAASC,EAASC,GAC/B,IAAIC,EAAOC,KACPC,EAAWD,KAAKC,SAChBC,EAAcC,OAAOC,KAArB,uBACJC,EAAEC,IAAIJ,GAAYK,KAAMV,EAAQU,KAAMC,cAAeP,GAAY,SAAAQ,GAC7D,IAAIC,EAAcX,EAAKY,WAAWF,GALtCb,EAAAA,MA2CCe,WAvCKT,SAAAA,GACF,IAAAU,KACAd,EAAAA,EAASY,KAQT,OAPHL,EAAAQ,KAHDC,EAAA,SAAAC,GAJJ,IAAAC,EAAAF,EAAAC,GAeYE,EAAWD,EAAOE,WAAWC,KAA7B,OAAwCH,EAAOE,WAAWE,oBAA1D,KAAkFJ,EAAOE,WALjGP,YACIC,GAAUS,MAAdL,EAAAE,WAAAI,GAAAL,MAAAA,GACAL,EAAIE,KAAOS,KAEPX,GA8BPY,WA1BOZ,SAAAA,GALJ,KAMCa,EANDjB,cAAAkB,QAAA,KAOAD,EAAOb,cAAPa,EAAAjB,cAAAkB,OAAA,EAAAD,EAAAjB,cAAAmB,OAAA,IAOA,IAAIC,EAASH,EAASjB,cAAlB,IAAmCiB,EAASI,cAA5C,IAA6DJ,EAASK,mBAJ1EN,EAAa,IAAAO,OACbC,aAAaxB,eACTiB,EAASjB,KAAAA,MAATwB,aAAkCxB,eAEtCyB,EAAIL,GAASH,EACbO,aAAIC,aAAmBF,KAAJG,UAAnBD,IAsBAE,YAnBC,WACDF,GAAAA,aAAaL,eAAb,gBAAA,CACAI,IAAAA,EAAaI,KAAAA,MAAeC,aAAKH,cAO7B,OAjBRH,OAAAO,KAAAC,GAAAZ,OAcI,OAAIK","file":"../../../scripts/mvc/toolshed/util.js","sourcesContent":["var searchShed = function(request, response) {\n    var that = this;\n    var shed_url = this.shed_url;\n    var base_url = `${Galaxy.root}api/tool_shed/search`;\n    $.get(base_url, { term: request.term, tool_shed_url: shed_url }, data => {\n        var result_list = that.shedParser(data);\n        response(result_list);\n    });\n};\n\nvar shedParser = jsondata => {\n    var results = [];\n    var hits = jsondata.hits;\n    $.each(hits, hit => {\n        var record = hits[hit];\n        var label = `${record.repository.name} by ${record.repository.repo_owner_username}: ${record.repository\n            .description}`;\n        var result = { value: record.repository.id, label: label };\n        results.push(result);\n    });\n    return results;\n};\n\nvar addToQueue = metadata => {\n    if (metadata.tool_shed_url.substr(-1) == \"/\") {\n        metadata.tool_shed_url = metadata.tool_shed_url.substr(0, metadata.tool_shed_url.length - 1);\n    }\n    var key = `${metadata.tool_shed_url}|${metadata.repository_id}|${metadata.changeset_revision}`;\n    var queued_repos = new Object();\n    if (localStorage.repositories) {\n        queued_repos = JSON.parse(localStorage.repositories);\n    }\n    queued_repos[key] = metadata;\n    localStorage.repositories = JSON.stringify(queued_repos);\n};\n\nvar queueLength = () => {\n    if (localStorage.hasOwnProperty(\"repositories\")) {\n        var repo_queue = JSON.parse(localStorage.repositories);\n        var queue_length = Object.keys(repo_queue).length;\n        return queue_length;\n    } else {\n        return 0;\n    }\n};\n\nexport default {\n    searchShed: searchShed,\n    shedParser: shedParser,\n    addToQueue: addToQueue,\n    queueLength: queueLength\n};\n"]}