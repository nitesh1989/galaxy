{"version":3,"sources":["mvc/history/hdca-model.js"],"names":["buildHDCASave","_super","attributes","options","ListDC","this","isNew","url","urlRoot","get","hcontentMixin","call","ListDatasetCollection","_historyContentModel2","default","HistoryContentMixin","_collectionModel2","PairDC","PairDatasetCollection","ListPairedDC","ListPairedDatasetCollection","ListOfListsDC","ListOfListsDatasetCollection","HistoryListDatasetCollection","extend","defaults","_","clone","prototype","save","toString","HistoryPairDatasetCollection","history_content_type","collection_type","HistoryListPairedDatasetCollection","model_class","HistoryListOfListsDatasetCollection","join"],"mappings":"yNAsBA,SAASA,EAAcC,GACnB,OAAO,SAAeC,EAAYC,GARlCC,OASQC,KAAKC,WACLH,EAAUA,OACFI,IAASF,KAAKG,QAAUH,KAAKI,IAAI,cAAzC,aACAP,EAAaA,OAdrBQ,KAAgB,sBAEhBN,EAASO,KAAAN,KAAAH,EAASU,uEAFlBF,QAAgBG,EAAAC,QAAgBC,qBAEhCX,EAASY,EAAAF,QAASF,sBAClBK,EAASD,EAAAF,QAASI,sBAClBC,EAAeH,EAAAF,QAASM,4BACxBC,EAAgBL,EAAAF,QAASQ,6BAI7BC,EAA+BnB,EAAAoB,OAAAd,GAAAc,QAEvBC,SAAIC,EAAAF,OAAAE,EAAJC,MAAkBvB,EAAAwB,UAAAH,WACdtB,qBAAUA,qBACVA,gBAAA,OACAD,YAAAA,wCAIP2B,KARD7B,EAAAI,EAAAwB,UAAAC,MAWJC,SAAA,WACA,MAAA,UAAA1B,EAAAwB,UAAAE,SAAAnB,KAAAN,SAwBI0B,EAA+Bd,EAAOO,OAAOd,GAAec,QAbxDK,SAAM7B,EAAAA,OAAAA,EAAcI,MAAOwB,EAAAA,UARsBH,WAwB7CO,qBAAsB,qBAd1BC,gBAAA,SACAH,YAAU,wCAmBVD,KAAM7B,EAAciB,EAAOW,UAAUC,MAGrCC,SAAU,WACN,MAAA,UAAiBb,EAAOW,UAAUE,SAASnB,KAAKN,SAXG6B,EADNf,EAAAK,OAAAd,GAAAc,QAoBrDC,SAAUC,EAAEF,OAAOE,EAAEC,MAAMR,EAAaS,UAAUH,WAb9CO,qBAAA,qBACAH,gBAAM7B,cAeNmC,YAAa,wCAVZN,KAAA7B,EAAAmB,EAAAS,UAAAC,MAITC,SAAA,WACA,MAAA,UAAAX,EAAAS,UAAAE,SAAAnB,KAAAN,SAEiE+B,EADkBf,EAAAG,OAAAd,GAAAc,QAmB/EC,SAAUC,EAAEF,OAAOE,EAAEC,MAAMN,EAAcO,UAAUH,WAZnDO,qBAAA,qBACAH,gBAAM7B,YAcFmC,YAAa,wCAThBN,KAAA7B,EAAAqB,EAAAO,UAAAC,MAGLC,SAAA,WACA,OAAA,uCAAAzB,KAAAI,IAAA,QAAA,KAAA4B,KAAA,kBAEkEd,6BADmBA,EAmBjFQ,6BAA8BA,EAZ9BG,mCAAAA,EACAL,oCAAoBR","file":"../../../scripts/mvc/history/hdca-model.js","sourcesContent":["import DC_MODEL from \"mvc/collection/collection-model\";\nimport HISTORY_CONTENT from \"mvc/history/history-content-model\";\nimport _l from \"utils/localization\";\n\n/*==============================================================================\n\nModels for DatasetCollections contained within a history.\n\nTODO:\n    these might be compactable to one class if some duplication with\n    collection-model is used.\n\n==============================================================================*/\nvar hcontentMixin = HISTORY_CONTENT.HistoryContentMixin;\n\nvar ListDC = DC_MODEL.ListDatasetCollection;\nvar PairDC = DC_MODEL.PairDatasetCollection;\nvar ListPairedDC = DC_MODEL.ListPairedDatasetCollection;\nvar ListOfListsDC = DC_MODEL.ListOfListsDatasetCollection;\n\n//==============================================================================\n/** Override to post to contents route w/o id. */\nfunction buildHDCASave(_super) {\n    return function _save(attributes, options) {\n        if (this.isNew()) {\n            options = options || {};\n            options.url = `${this.urlRoot + this.get(\"history_id\")}/contents`;\n            attributes = attributes || {};\n            attributes.type = \"dataset_collection\";\n        }\n        return _super.call(this, attributes, options);\n    };\n}\n\n//==============================================================================\n/** @class Backbone model for List Dataset Collection within a History.\n */\nvar HistoryListDatasetCollection = ListDC.extend(hcontentMixin).extend(\n    /** @lends HistoryListDatasetCollection.prototype */ {\n        defaults: _.extend(_.clone(ListDC.prototype.defaults), {\n            history_content_type: \"dataset_collection\",\n            collection_type: \"list\",\n            model_class: \"HistoryDatasetCollectionAssociation\"\n        }),\n\n        /** Override to post to contents route w/o id. */\n        save: buildHDCASave(ListDC.prototype.save),\n\n        /** String representation. */\n        toString: function() {\n            return `History${ListDC.prototype.toString.call(this)}`;\n        }\n    }\n);\n\n//==============================================================================\n/** @class Backbone model for Pair Dataset Collection within a History.\n *  @constructs\n */\nvar HistoryPairDatasetCollection = PairDC.extend(hcontentMixin).extend(\n    /** @lends HistoryPairDatasetCollection.prototype */ {\n        defaults: _.extend(_.clone(PairDC.prototype.defaults), {\n            history_content_type: \"dataset_collection\",\n            collection_type: \"paired\",\n            model_class: \"HistoryDatasetCollectionAssociation\"\n        }),\n\n        /** Override to post to contents route w/o id. */\n        save: buildHDCASave(PairDC.prototype.save),\n\n        /** String representation. */\n        toString: function() {\n            return `History${PairDC.prototype.toString.call(this)}`;\n        }\n    }\n);\n\n//==============================================================================\n/** @class Backbone model for List of Pairs Dataset Collection within a History. */\nvar HistoryListPairedDatasetCollection = ListPairedDC.extend(hcontentMixin).extend({\n    defaults: _.extend(_.clone(ListPairedDC.prototype.defaults), {\n        history_content_type: \"dataset_collection\",\n        collection_type: \"list:paired\",\n        model_class: \"HistoryDatasetCollectionAssociation\"\n    }),\n\n    /** Override to post to contents route w/o id. */\n    save: buildHDCASave(ListPairedDC.prototype.save),\n\n    /** String representation. */\n    toString: function() {\n        return `History${ListPairedDC.prototype.toString.call(this)}`;\n    }\n});\n\n//==============================================================================\n/** @class Backbone model for List of Lists Dataset Collection within a History. */\nvar HistoryListOfListsDatasetCollection = ListOfListsDC.extend(hcontentMixin).extend({\n    defaults: _.extend(_.clone(ListOfListsDC.prototype.defaults), {\n        history_content_type: \"dataset_collection\",\n        collection_type: \"list:list\",\n        model_class: \"HistoryDatasetCollectionAssociation\"\n    }),\n\n    /** Override to post to contents route w/o id. */\n    save: buildHDCASave(ListOfListsDC.prototype.save),\n\n    /** String representation. */\n    toString: function() {\n        return [\"HistoryListOfListsDatasetCollection(\", this.get(\"name\"), \")\"].join(\"\");\n    }\n});\n\n//==============================================================================\nexport default {\n    HistoryListDatasetCollection: HistoryListDatasetCollection,\n    HistoryPairDatasetCollection: HistoryPairDatasetCollection,\n    HistoryListPairedDatasetCollection: HistoryListPairedDatasetCollection,\n    HistoryListOfListsDatasetCollection: HistoryListOfListsDatasetCollection\n};\n"]}