{"version":3,"sources":["mvc/page/page-list.js"],"names":["define","Utils","GridView","View","Backbone","extend","initialize","options","$","this","self","Model","setElement","url","Galaxy","response","success","model","set","render","grid","attributes","$el","empty","append","_templateShared","$tmpl","shared_by_others","length","$table","_","each","page","index","root","username","slug","display_url","escape","title"],"mappings":"YACAA,SAAU,cAAe,sBAAwB,SAAUC,EAAOC,GAmD9D,OACIC,KArDRC,SAAAD,KAAAE,QACUC,WAAA,SAAeC,GACjBJ,GAAOC,GAAAA,IACPE,MAAAA,WAAYE,EAAA,WACRC,KAAIC,MAAO,GAAXN,UAAAO,MACAV,EAAKW,KACLC,IAAaC,OAAIV,KAASO,YAC1BV,QAAU,SAAAc,GACNF,EAAAA,aADM,EAENG,EAAUC,MAAAC,IAAAH,GACNA,EAAAA,aAKXI,OAb2B,WAgBxB,GAAIC,GAAO,GAAIlB,GAAUO,KAAKQ,MAAMI,WADxCF,MAAQG,IAAAC,QAAAC,OAAWJ,EAAAE,KACfb,KAAIW,IAAAA,OAAWlB,KAAAA,oBAGlBuB,gBAnB2B,WAsBxB,GAAIC,GAAQlB,EAAI,uDAGZD,EAAUE,KAAKQ,MAAMI,UACzB,IAAKd,EAAQoB,kBAAoBpB,EAAQoB,iBAAiBC,OAA1D,EAAuE,CACnE,GAAIC,GAASrB,EAAG,8IADpBsB,GAAAC,KAiBOxB,EAAAoB,iBAAA,SAAAK,EAAAC,GACHP,GAAMF,GAAQV,OAAAoB,KAAA,8CAAdF,EAAAG,SAAA,SAAAH,EAAAI,IACHP,GAAAL,OAAA,oBAEJa,EAAA,KAAAP,EAAAQ,OAAAN,EAAAO,OAAA,gBARwCT,EAAEQ,OAAQN,EAAKG,UAAa,gBAWzET,EAAAF,OAAAK,OANYH,GAAMF,OAAQ,sCAElB,OAAOE","file":"../../../scripts/mvc/page/page-list.js","sourcesContent":["/** This class renders the page list. */\ndefine( [ 'utils/utils', 'mvc/grid/grid-view' ], function( Utils, GridView ) {\n    var View = Backbone.View.extend({\n        initialize: function( options ) {\n            var self = this;\n            this.setElement( $( '<div/>' ) );\n            this.model = new Backbone.Model();\n            Utils.get({\n                url     : Galaxy.root + 'page/list',\n                success : function( response ) {\n                    response[ 'dict_format' ] = true;\n                    self.model.set( response );\n                    self.render();\n                }\n            });\n        },\n\n        render: function() {\n            var grid = new GridView( this.model.attributes );\n            this.$el.empty().append( grid.$el );\n            this.$el.append( this._templateShared() );\n        },\n\n        _templateShared: function() {\n            var $tmpl = $(  '<div>' +\n                                '<h2>Pages shared with you by others</h2>' +\n                            '</div>' );\n            var options = this.model.attributes;\n            if ( options.shared_by_others && options.shared_by_others.length > 0 ) {\n                var $table = $( '<table class=\"colored\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">' +\n                                    '<tr class=\"header\">' +\n                                        '<th>Title</th>' +\n                                        '<th>Owner</th>' +\n                                    '</tr>' +\n                                '</table>' );\n                _.each( options.shared_by_others, function( page, index ) {\n                    var display_url = Galaxy.root + 'page/display_by_username_and_slug?username=' + page.username + '&slug=' + page.slug;\n                    $table.append(  '<tr>' +\n                                        '<td>' +\n                                            '<a href=\"' + display_url + '\">' + _.escape( page.title ) + '</a>' +\n                                        '</td>' +\n                                        '<td>' + _.escape( page.username ) + '</td>' +\n                                    '</tr>' );\n                });\n                $tmpl.append( $table );\n            } else {\n                $tmpl.append( 'No pages have been shared with you.' );\n            }\n            return $tmpl;\n        }\n    });\n\n    return {\n        View: View\n    }\n});"]}