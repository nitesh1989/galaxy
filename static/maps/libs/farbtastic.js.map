{"version":3,"sources":["libs/farbtastic.js"],"names":["$","fn","farbtastic","options","this","__debug","container","_farbtastic","fb","linkTo","callback","_typeof","unbind","updateValue","color","value","event","setColor","unpack","rgb","hsl","RGBToHSL","setHSL","HSLToRGB","pack","initWidget","width","height","find","attr","dim","css","end","e","document","createElement","browser","msie","left","mid","wheelWidth","top","floor","square","Math","markerSize","solidFill","cnvMask","ctxMask","cnvOverlay","ctxOverlay","drawCircle","getContext","translate","drawMask","color1","d1","r","Date","radius","save","lineWidth","w","PI","scale","angle1","m","i","angle2","x1","cos","sin","y1","am","y2","tan","color2","xm","ym","corr","abs","grad","createLinearGradient","addColorStop","d2","x2","quadraticCurveTo","r1","lineTo","r2","fill","beginPath","moveTo","nudge","restore","size","calculateMask","y","sizey","outputPixel","isx","l","sizex","isy","x","s","a","min","c","sq","buffer","frame","ctx","getImageData","sz","data","putImageData","drawImage","cache_last","cache","round","c_last","a_last","packDX","position","filter","appendTo","push","fillStyle","fillRect","lw","ceil","angle","c1","invert","c2","circles","strokeStyle","arc","stroke","updateDisplay","drawMarkers","backgroundColor","each","change","call","widgetCoords","pageX","offset","pageY","dragging","bind","mousemove","mouseup","circleDrag","max","pos","hue","lum","sat","dec2hex","toString","g","b","length","parseInt","substring","m2","m1","hueToRGB","h","delta","extend","mousedown","jQuery"],"mappings":"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","file":"../../scripts/libs/farbtastic.js","sourcesContent":["// Farbtastic 2.0.0-alpha.1\n(function ($) {\n\nvar __debug = false;\n\n$.fn.farbtastic = function (options) {\n  $.farbtastic(this, options);\n  return this;\n};\n\n$.farbtastic = function (container, options) {\n  var container = $(container)[0];\n  return container.farbtastic || (container.farbtastic = new $._farbtastic(container, options));\n}\n\n$._farbtastic = function (container, options) {\n  var fb = this;\n\n  /////////////////////////////////////////////////////\n\n  /**\n   * Link to the given element(s) or callback.\n   */\n  fb.linkTo = function (callback) {\n    // Unbind previous nodes\n    if (typeof fb.callback == 'object') {\n      $(fb.callback).unbind('keyup', fb.updateValue);\n    }\n\n    // Reset color\n    fb.color = null;\n\n    // Bind callback or elements\n    if (typeof callback == 'function') {\n      fb.callback = callback;\n    }\n    else if (typeof callback == 'object' || typeof callback == 'string') {\n      fb.callback = $(callback);\n      fb.callback.bind('keyup', fb.updateValue);\n      if (fb.callback[0].value) {\n        fb.setColor(fb.callback[0].value);\n      }\n    }\n    return this;\n  }\n  fb.updateValue = function (event) {\n    if (this.value && this.value != fb.color) {\n      fb.setColor(this.value);\n    }\n  }\n\n  /**\n   * Change color with HTML syntax #123456\n   */\n  fb.setColor = function (color) {\n    var unpack = fb.unpack(color);\n    if (fb.color != color && unpack) {\n      fb.color = color;\n      fb.rgb = unpack;\n      fb.hsl = fb.RGBToHSL(fb.rgb);\n      fb.updateDisplay();\n    }\n    return this;\n  }\n\n  /**\n   * Change color with HSL triplet [0..1, 0..1, 0..1]\n   */\n  fb.setHSL = function (hsl) {\n    fb.hsl = hsl;\n    fb.rgb = fb.HSLToRGB(hsl);\n    fb.color = fb.pack(fb.rgb);\n    fb.updateDisplay();\n    return this;\n  }\n\n  /////////////////////////////////////////////////////\n\n  /**\n   * Initialize the color picker widget.\n   */\n  fb.initWidget = function () {\n\n    // Insert markup and size accordingly.\n    var dim = {\n      width: options.width,\n      height: options.width\n    };\n    $(container)\n      .html(\n        '<div class=\"farbtastic\" style=\"position: relative\">' +\n          '<div class=\"farbtastic-solid\"></div>' +\n          '<canvas class=\"farbtastic-mask\"></canvas>' +\n          '<canvas class=\"farbtastic-overlay\"></canvas>' +\n        '</div>'\n      )\n      .find('*').attr(dim).css(dim).end()\n      .find('div>*').css('position', 'absolute');\n\n    // IE Fix: Recreate canvas elements with doc.createElement and excanvas.\n    $.browser.msie || false && $('canvas', container).each(function () {\n      // Fetch info.\n      var attr = { 'class': $(this).attr('class'), style: this.getAttribute('style') },\n          e = document.createElement('canvas');\n      // Replace element.\n      $(this).before($(e).attr(attr)).remove();\n      // Init with explorerCanvas.\n      G_vmlCanvasManager && G_vmlCanvasManager.initElement(e);\n      // Set explorerCanvas elements dimensions and absolute positioning.\n      $(e).attr(dim).css(dim).css('position', 'absolute')\n        .find('*').attr(dim).css(dim);\n    });\n\n    // Determine layout\n    fb.radius = (options.width - options.wheelWidth) / 2 - 1;\n    fb.square = Math.floor((fb.radius - options.wheelWidth / 2) * 0.7) - 1;\n    fb.mid = Math.floor(options.width / 2);\n    fb.markerSize = options.wheelWidth * 0.3;\n    fb.solidFill = $('.farbtastic-solid', container).css({\n      width: fb.square * 2 - 1,\n      height: fb.square * 2 - 1,\n      left: fb.mid - fb.square,\n      top: fb.mid - fb.square\n    });\n\n    // Set up drawing context.\n    fb.cnvMask = $('.farbtastic-mask', container);\n    fb.ctxMask = fb.cnvMask[0].getContext('2d');\n    fb.cnvOverlay = $('.farbtastic-overlay', container);\n    fb.ctxOverlay = fb.cnvOverlay[0].getContext('2d');\n    fb.ctxMask.translate(fb.mid, fb.mid);\n    fb.ctxOverlay.translate(fb.mid, fb.mid);\n\n    // Draw widget base layers.\n    fb.drawCircle();\n    fb.drawMask();\n  }\n\n  /**\n   * Draw the color wheel.\n   */\n  fb.drawCircle = function () {\n    var tm = +(new Date());\n    // Draw a hue circle with a bunch of gradient-stroked beziers.\n    // Have to use beziers, as gradient-stroked arcs don't work.\n    var n = 24,\n        r = fb.radius,\n        w = options.wheelWidth,\n        nudge = 8 / r / n * Math.PI, // Fudge factor for seams.\n        m = fb.ctxMask,\n        angle1 = 0, color1, d1;\n    m.save();\n    m.lineWidth = w / r;\n    m.scale(r, r);\n    // Each segment goes from angle1 to angle2.\n    for (var i = 0; i <= n; ++i) {\n      var d2 = i / n,\n          angle2 = d2 * Math.PI * 2,\n          // Endpoints\n          x1 = Math.sin(angle1), y1 = -Math.cos(angle1);\n          x2 = Math.sin(angle2), y2 = -Math.cos(angle2),\n          // Midpoint chosen so that the endpoints are tangent to the circle.\n          am = (angle1 + angle2) / 2,\n          tan = 1 / Math.cos((angle2 - angle1) / 2),\n          xm = Math.sin(am) * tan, ym = -Math.cos(am) * tan,\n          // New color\n          color2 = fb.pack(fb.HSLToRGB([d2, 1, 0.5]));\n      if (i > 0) {\n        if ($.browser.msie || false) {\n          // IE's gradient calculations mess up the colors. Correct along the diagonals.\n          var corr = (1 + Math.min(Math.abs(Math.tan(angle1)), Math.abs(Math.tan(Math.PI / 2 - angle1)))) / n;\n          color1 = fb.pack(fb.HSLToRGB([d1 - 0.15 * corr, 1, 0.5]));\n          color2 = fb.pack(fb.HSLToRGB([d2 + 0.15 * corr, 1, 0.5]));\n          // Create gradient fill between the endpoints.\n          var grad = m.createLinearGradient(x1, y1, x2, y2);\n          grad.addColorStop(0, color1);\n          grad.addColorStop(1, color2);\n          m.fillStyle = grad;\n          // Draw quadratic curve segment as a fill.\n          var r1 = (r + w / 2) / r, r2 = (r - w / 2) / r; // inner/outer radius.\n          m.beginPath();\n          m.moveTo(x1 * r1, y1 * r1);\n          m.quadraticCurveTo(xm * r1, ym * r1, x2 * r1, y2 * r1);\n          m.lineTo(x2 * r2, y2 * r2);\n          m.quadraticCurveTo(xm * r2, ym * r2, x1 * r2, y1 * r2);\n          m.fill();\n        }\n        else {\n          // Create gradient fill between the endpoints.\n          var grad = m.createLinearGradient(x1, y1, x2, y2);\n          grad.addColorStop(0, color1);\n          grad.addColorStop(1, color2);\n          m.strokeStyle = grad;\n          // Draw quadratic curve segment.\n          m.beginPath();\n          m.moveTo(x1, y1);\n          m.quadraticCurveTo(xm, ym, x2, y2);\n          m.stroke();\n        }\n      }\n      // Prevent seams where curves join.\n      angle1 = angle2 - nudge; color1 = color2; d1 = d2;\n    }\n    m.restore();\n    __debug && $('body').append('<div>drawCircle '+ (+(new Date()) - tm) +'ms');\n  };\n\n  /**\n   * Draw the saturation/luminance mask.\n   */\n  fb.drawMask = function () {\n    var tm = +(new Date());\n\n    // Iterate over sat/lum space and calculate appropriate mask pixel values.\n    var size = fb.square * 2, sq = fb.square;\n    function calculateMask(sizex, sizey, outputPixel) {\n      var isx = 1 / sizex, isy = 1 / sizey;\n      for (var y = 0; y <= sizey; ++y) {\n        var l = 1 - y * isy;\n        for (var x = 0; x <= sizex; ++x) {\n          var s = 1 - x * isx;\n          // From sat/lum to alpha and color (grayscale)\n          var a = 1 - 2 * Math.min(l * s, (1 - l) * s);\n          var c = (a > 0) ? ((2 * l - 1 + a) * .5 / a) : 0;\n          outputPixel(x, y, c, a);\n        }\n      }\n    }\n\n    // Method #1: direct pixel access (new Canvas).\n    if (fb.ctxMask.getImageData) {\n      // Create half-resolution buffer.\n      var sz = Math.floor(size / 2);\n      var buffer = document.createElement('canvas');\n      buffer.width = buffer.height = sz + 1;\n      var ctx = buffer.getContext('2d');\n      var frame = ctx.getImageData(0, 0, sz + 1, sz + 1);\n\n      var i = 0;\n      calculateMask(sz, sz, function (x, y, c, a) {\n        frame.data[i++] = frame.data[i++] = frame.data[i++] = c * 255;\n        frame.data[i++] = a * 255;\n      });\n\n      ctx.putImageData(frame, 0, 0);\n      fb.ctxMask.drawImage(buffer, 0, 0, sz + 1, sz + 1, -sq, -sq, sq * 2, sq * 2);\n    }\n    // Method #2: drawing commands (old Canvas).\n    else if (!($.browser.msie || false)) {\n      // Render directly at half-resolution\n      var sz = Math.floor(size / 2);\n      calculateMask(sz, sz, function (x, y, c, a) {\n        c = Math.round(c * 255);\n        fb.ctxMask.fillStyle = 'rgba(' + c + ', ' + c + ', ' + c + ', ' + a +')';\n        fb.ctxMask.fillRect(x * 2 - sq - 1, y * 2 - sq - 1, 2, 2);\n      });\n    }\n    // Method #3: vertical DXImageTransform gradient strips (IE).\n    else {\n      var cache_last, cache, w = 6; // Each strip is 6 pixels wide.\n      var sizex = Math.floor(size / w);\n      // 6 vertical pieces of gradient per strip.\n      calculateMask(sizex, 6, function (x, y, c, a) {\n        if (x == 0) {\n          cache_last = cache;\n          cache = [];\n        }\n        c = Math.round(c * 255);\n        a = Math.round(a * 255);\n        // We can only start outputting gradients once we have two rows of pixels.\n        if (y > 0) {\n          var c_last = cache_last[x][0],\n              a_last = cache_last[x][1],\n              color1 = fb.packDX(c_last, a_last),\n              color2 = fb.packDX(c, a),\n              y1 = Math.round(fb.mid + ((y - 1) * .333 - 1) * sq),\n              y2 = Math.round(fb.mid + (y * .333 - 1) * sq);\n          $('<div>').css({\n            position: 'absolute',\n            filter: \"progid:DXImageTransform.Microsoft.Gradient(StartColorStr=\"+ color1 +\", EndColorStr=\"+ color2 +\", GradientType=0)\",\n            top: y1,\n            height: y2 - y1,\n            // Avoid right-edge sticking out.\n            left: fb.mid + (x * w - sq - 1),\n            width: w - (x == sizex ? Math.round(w / 2) : 0)\n          }).appendTo(fb.cnvMask);\n        }\n        cache.push([c, a]);\n      });\n    }\n    __debug && $('body').append('<div>drawMask '+ (+(new Date()) - tm) +'ms');\n  }\n\n  /**\n   * Draw the selection markers.\n   */\n  fb.drawMarkers = function () {\n    // Determine marker dimensions\n    var sz = options.width, lw = Math.ceil(fb.markerSize / 4), r = fb.markerSize - lw + 1;\n    var angle = fb.hsl[0] * 6.28,\n        x1 =  Math.sin(angle) * fb.radius,\n        y1 = -Math.cos(angle) * fb.radius,\n        x2 = 2 * fb.square * (.5 - fb.hsl[1]),\n        y2 = 2 * fb.square * (.5 - fb.hsl[2]),\n        c1 = fb.invert ? '#fff' : '#000',\n        c2 = fb.invert ? '#000' : '#fff';\n    var circles = [\n      { x: x1, y: y1, r: r,             c: '#000', lw: lw + 1 },\n      { x: x1, y: y1, r: fb.markerSize, c: '#fff', lw: lw },\n      { x: x2, y: y2, r: r,             c: c2,     lw: lw + 1 },\n      { x: x2, y: y2, r: fb.markerSize, c: c1,     lw: lw },\n    ];\n\n    // Update the overlay canvas.\n    fb.ctxOverlay.clearRect(-fb.mid, -fb.mid, sz, sz);\n    for (var i = 0; i < circles.length; i++) {\n      var c = circles[i];\n      fb.ctxOverlay.lineWidth = c.lw;\n      fb.ctxOverlay.strokeStyle = c.c;\n      fb.ctxOverlay.beginPath();\n      fb.ctxOverlay.arc(c.x, c.y, c.r, 0, Math.PI * 2, true);\n      fb.ctxOverlay.stroke();\n    }\n  }\n\n  /**\n   * Update the markers and styles\n   */\n  fb.updateDisplay = function () {\n    // Determine whether labels/markers should invert.\n    fb.invert = (fb.rgb[0] * 0.3 + fb.rgb[1] * .59 + fb.rgb[2] * .11) <= 0.6;\n\n    // Update the solid background fill.\n    fb.solidFill.css('backgroundColor', fb.pack(fb.HSLToRGB([fb.hsl[0], 1, 0.5])));\n\n    // Draw markers\n    fb.drawMarkers();\n\n    // Linked elements or callback\n    if (typeof fb.callback == 'object') {\n      // Set background/foreground color\n      $(fb.callback).css({\n        backgroundColor: fb.color,\n        color: fb.invert ? '#fff' : '#000'\n      });\n\n      // Change linked value\n      $(fb.callback).each(function() {\n        if ((typeof this.value == 'string') && this.value != fb.color) {\n          this.value = fb.color;\n        }\n      }).change();\n    }\n    else if (typeof fb.callback == 'function') {\n      fb.callback.call(fb, fb.color);\n    }\n  }\n\n  /**\n   * Helper for returning coordinates relative to the center.\n   */\n  fb.widgetCoords = function (event) {\n    return {\n      x: event.pageX - fb.offset.left - fb.mid,\n      y: event.pageY - fb.offset.top - fb.mid\n    };\n  }\n\n  /**\n   * Mousedown handler\n   */\n  fb.mousedown = function (event) {\n    // Capture mouse\n    if (!$._farbtastic.dragging) {\n      $(document).bind('mousemove', fb.mousemove).bind('mouseup', fb.mouseup);\n      $._farbtastic.dragging = true;\n    }\n\n    // Update the stored offset for the widget.\n    fb.offset = $(container).offset();\n\n    // Check which area is being dragged\n    var pos = fb.widgetCoords(event);\n    fb.circleDrag = Math.max(Math.abs(pos.x), Math.abs(pos.y)) > (fb.square + 2);\n\n    // Process\n    fb.mousemove(event);\n    return false;\n  }\n\n  /**\n   * Mousemove handler\n   */\n  fb.mousemove = function (event) {\n    // Get coordinates relative to color picker center\n    var pos = fb.widgetCoords(event);\n\n    // Set new HSL parameters\n    if (fb.circleDrag) {\n      var hue = Math.atan2(pos.x, -pos.y) / 6.28;\n      fb.setHSL([(hue + 1) % 1, fb.hsl[1], fb.hsl[2]]);\n    }\n    else {\n      var sat = Math.max(0, Math.min(1, -(pos.x / fb.square / 2) + .5));\n      var lum = Math.max(0, Math.min(1, -(pos.y / fb.square / 2) + .5));\n      fb.setHSL([fb.hsl[0], sat, lum]);\n    }\n    return false;\n  }\n\n  /**\n   * Mouseup handler\n   */\n  fb.mouseup = function () {\n    // Uncapture mouse\n    $(document).unbind('mousemove', fb.mousemove);\n    $(document).unbind('mouseup', fb.mouseup);\n    $._farbtastic.dragging = false;\n  }\n\n  /* Various color utility functions */\n  fb.dec2hex = function (x) {\n    return (x < 16 ? '0' : '') + x.toString(16);\n  }\n\n  fb.packDX = function (c, a) {\n    return '#' + fb.dec2hex(a) + fb.dec2hex(c) + fb.dec2hex(c) + fb.dec2hex(c);\n  };\n\n  fb.pack = function (rgb) {\n    var r = Math.round(rgb[0] * 255);\n    var g = Math.round(rgb[1] * 255);\n    var b = Math.round(rgb[2] * 255);\n    return '#' + fb.dec2hex(r) + fb.dec2hex(g) + fb.dec2hex(b);\n  };\n\n  fb.unpack = function (color) {\n    if (color.length == 7) {\n      function x(i) {\n        return parseInt(color.substring(i, i + 2), 16) / 255;\n      }\n      return [ x(1), x(3), x(5) ];\n    }\n    else if (color.length == 4) {\n      function x(i) {\n        return parseInt(color.substring(i, i + 1), 16) / 15;\n      }\n      return [ x(1), x(2), x(3) ];\n    }\n  };\n\n  fb.HSLToRGB = function (hsl) {\n    var m1, m2, r, g, b;\n    var h = hsl[0], s = hsl[1], l = hsl[2];\n    m2 = (l <= 0.5) ? l * (s + 1) : l + s - l * s;\n    m1 = l * 2 - m2;\n    return [\n      this.hueToRGB(m1, m2, h + 0.33333),\n      this.hueToRGB(m1, m2, h),\n      this.hueToRGB(m1, m2, h - 0.33333)\n    ];\n  };\n\n  fb.hueToRGB = function (m1, m2, h) {\n    h = (h + 1) % 1;\n    if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;\n    if (h * 2 < 1) return m2;\n    if (h * 3 < 2) return m1 + (m2 - m1) * (0.66666 - h) * 6;\n    return m1;\n  };\n\n  fb.RGBToHSL = function (rgb) {\n    var r = rgb[0], g = rgb[1], b = rgb[2],\n        min = Math.min(r, g, b),\n        max = Math.max(r, g, b),\n        delta = max - min,\n        h = 0,\n        s = 0,\n        l = (min + max) / 2;\n    if (l > 0 && l < 1) {\n      s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));\n    }\n    if (delta > 0) {\n      if (max == r && max != g) h += (g - b) / delta;\n      if (max == g && max != b) h += (2 + (b - r) / delta);\n      if (max == b && max != r) h += (4 + (r - g) / delta);\n      h /= 6;\n    }\n    return [h, s, l];\n  };\n\n  // Parse options.\n  if (!options.callback) {\n    options = { callback: options };\n  }\n  options = $.extend({\n    width: 300,\n    wheelWidth: (options.width || 300) / 10,\n    callback: null\n  }, options);\n\n  // Initialize.\n  fb.initWidget();\n\n  // Install mousedown handler (the others are set on the document on-demand)\n  $('canvas.farbtastic-overlay', container).mousedown(fb.mousedown);\n\n  // Set linked elements/callback\n  if (options.callback) {\n    fb.linkTo(options.callback);\n  }\n  // Set to gray.\n  if (!fb.color) fb.setColor('#808080');\n}\n\n})(jQuery);\n"]}