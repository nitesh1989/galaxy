{"version":3,"sources":["libs/bbi/jquery-ajax-native.js"],"names":["root","factory","define","amd","_typeof","module","exports","require","jQuery","undefined","$","ajaxSettings","native","converters","support","1223","xhrCallbacks","xhrSupported","xhr","key","ajax","options","cors","crossDomain","ajaxTransport","callback","headers","complete","i","id","xhrId","responses","url","async","username","password","xhrFields","open","mimeType","overrideMimeType","setRequestHeader","onload","onerror","abort","type","response","xhrSuccessStatus","status","getAllResponseHeaders","hasContent","data","e","responseType","dataType","success"],"mappings":"oOAAA,SAAAA,EAAAC,GAK0B,kBAAXC,SAAyBA,OAAOC,IAF/CD,QAAA,UAAAD,GAC0B,YAAzB,mBAAgBA,SAAhB,YAAAG,QAAgBH,UACbI,OAGWC,QAAOA,EAAPC,QAAA,WAGPN,EAAAD,EAAAQ,aAXRC,GAQW,SAKAC,GACH,GAAAC,GAAAD,EAAAC,YACAV,GAAQD,eAARY,OAAA,iBACHD,EAAAE,WAAA,aAAA,CAZJ,IAAAC,MAcOH,EAAAA,EACJA,GAEIG,EAAAA,IAGIC,KAAA,KAEAC,KACAC,EAAAT,OAAAG,aAAAO,KAGJF,QAAAA,eACAC,EAAAA,QAAAA,GAAeT,SAAOG,WAC1B,IAAA,GAAAQ,KAAAH,GACAA,EAAAG,OAIYH,EAAAA,OAAAA,GAAA,mBAAAC,GACHH,EAAAM,KAAAH,IAAAA,EAGTH,EAAAA,cAAgB,SAACG,SAAkBI,GACnCP,GAAQM,EAER,IAAAN,EAAAQ,MAAAL,IAAAI,EAAAE,YACEC,OACMC,KAAJ,SAAAC,EAAAC,GACA,GAAAC,GACKV,EAAgBD,EAAAA,MACVY,IAAAC,EACGC,IASF,IARAb,EACIA,KAAMG,EAAQH,KADlBG,EAAAW,IAAAX,EAAAY,MAAAZ,EAAAa,SAAAb,EAAAc,UAQKd,EAAQe,UAHTC,IAAMhB,IAAAA,GAAcA,UAKhBH,EAAKU,GAAMP,EAAQe,UAAWR,EACjCP,GAAAiB,UAAApB,EAAAqB,kBACJrB,EAAAqB,iBAAAlB,EAAAiB,UAQDjB,EAAAE,aAAAG,EAAA,sBACAA,EAAA,oBAAA,iBAIIA,KAAAA,IAAAA,GACHR,EAAAsB,iBAAAZ,EAAAF,EAAAE,GAIGV,GAAIsB,SAAAA,GACP,MAAA,YAKYf,UAHbT,GAAAa,GACWJ,EAAAP,EAAAuB,OAAiBvB,EAAAwB,QAAA,KAEJ,UAAXjB,EACDP,EAAOF,QACQyB,UAAJvB,EAKPS,EAFIgB,EAAAA,OACDzB,EAAK0B,aAOR1B,EAAA2B,WACAd,EAAAnB,OAAAM,EAAA2B,UAGClB,EAGGmB,EAAkB5B,EAAI6B,SAAY7B,EAAI6B,OAD1CpB,EAAAA,WAMHI,EACJb,EAAA8B,6BAQT9B,EAAAuB,OAAAhB,IACAA,EAAAA,QAAWT,EAAAA,SAGPS,EAAAT,EAAAa,GAAAJ,EAAA,QAEH,KAEGP,EAAKO,KAAAA,EAAWwB,YAAA5B,EAAA6B,MAAA,MACZ,MAAAC,GAEP,GAAA1B,EAnFF,KAAA0B,KAyFER,MAAA,WACJlB,GA1FLA,QAqGAW,EAAAA,UAAAA,SAAWJ,EAAAP,GACP2B,MAAAA,GAAAA,MADOC,SAHD,SAMVC,IAAAA,EANJlB,WADJgB,aAAA,eAOQE,QAAS7B","file":"../../../scripts/libs/bbi/jquery-ajax-native.js","sourcesContent":["//     jQuery Ajax Native Plugin\n\n//     (c) 2015 Tarik Zakaria Benmerar, Acigna Inc.\n//      jQuery Ajax Native Plugin may be freely distributed under the MIT license.\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('jquery'));\n    } else {\n        // Browser globals (root is window)\n        factory(root.jQuery);\n    }\n}(this, function ( $ ) {\n    var ajaxSettings = $.ajaxSettings;\n    ajaxSettings.responseFields.native = 'responseNative';\n    ajaxSettings.converters[ '* native' ] = true;\n    var support = {},\n        xhrId = 0,\n        xhrSuccessStatus = {\n            // file protocol always yields status code 0, assume 200\n            0: 200,\n            // Support: IE9\n            // #1450: sometimes IE returns 1223 when it should be 204\n            1223: 204\n        },\n        xhrCallbacks = {},\n        xhrSupported = jQuery.ajaxSettings.xhr();\n    // Support: IE9\n    // Open requests must be manually aborted on unload (#5280)\n    if ( window.ActiveXObject ) {\n        $( window ).on( \"unload\", function() {\n            for ( var key in xhrCallbacks ) {\n                xhrCallbacks[ key ]();\n            }\n        });\n    }\n    support.cors = !!xhrSupported && ( \"withCredentials\" in xhrSupported );\n    support.ajax = xhrSupported = !!xhrSupported;\n\n    //Native Data Type Ajax Transport\n    $.ajaxTransport('native', function ( options ) {\n        var callback;\n        // Cross domain only allowed if supported through XMLHttpRequest\n        if ( support.cors || xhrSupported && !options.crossDomain ) {\n            return {\n                send: function( headers, complete ) {\n                    var i,\n                        xhr = options.xhr(),\n                        id = ++xhrId,\n                        responses = {};\n\n                    xhr.open( options.type, options.url, options.async, options.username, options.password );\n\n                    // Apply custom fields if provided\n                    if ( options.xhrFields ) {\n                        for ( i in options.xhrFields ) {\n                            xhr[ i ] = options.xhrFields[ i ];\n                        }\n                    }\n\n                    // Override mime type if needed\n                    if ( options.mimeType && xhr.overrideMimeType ) {\n                        xhr.overrideMimeType( options.mimeType );\n                    }\n\n                    // X-Requested-With header\n                    // For cross-domain requests, seeing as conditions for a preflight are\n                    // akin to a jigsaw puzzle, we simply never set it to be sure.\n                    // (it can always be set on a per-request basis or even using ajaxSetup)\n                    // For same-domain requests, won't change header if already provided.\n                    if ( !options.crossDomain && !headers[\"X-Requested-With\"] ) {\n                        headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n                    }\n\n                    // Set headers\n                    for ( i in headers ) {\n                        xhr.setRequestHeader( i, headers[ i ] );\n                    }\n\n                    // Callback\n                    callback = function( type ) {\n                        return function() {\n                            if ( callback ) {\n                                delete xhrCallbacks[ id ];\n                                callback = xhr.onload = xhr.onerror = null;\n\n                                if ( type === \"abort\" ) {\n                                    xhr.abort();\n                                } else if ( type === \"error\" ) {\n                                    complete(\n                                        // file: protocol always yields status 0; see #8605, #14207\n                                        xhr.status,\n                                        xhr.statusText\n                                    );\n                                } else {\n                                    // The native response associated with the responseType\n                                    // Stored in the xhr.response attribute (XHR2 Spec)\n                                    if ( xhr.response ) {\n                                        responses.native = xhr.response;\n                                    }\n\n                                    complete(\n                                        xhrSuccessStatus[ xhr.status ] || xhr.status,\n                                        xhr.statusText,\n                                        responses,\n                                        xhr.getAllResponseHeaders()\n                                    );\n                                }\n                            }\n                        };\n                    };\n\n                    // Listen to events\n                    xhr.onload = callback();\n                    xhr.onerror = callback(\"error\");\n\n                    // Create the abort callback\n                    callback = xhrCallbacks[ id ] = callback(\"abort\");\n\n                    try {\n                        // Do send the request (this may raise an exception)\n                        xhr.send( options.hasContent && options.data || null );\n                    } catch ( e ) {\n                        // #14683: Only rethrow if this hasn't been notified as an error yet\n                        if ( callback ) {\n                            throw e;\n                        }\n                    }\n                },\n\n                abort: function() {\n                    if ( callback ) {\n                        callback();\n                    }\n                }\n            };\n        }\n    });\n\n\n    //$.getNative wrapper\n    $.getNative = function ( url, callback ) {\n        return $.ajax({\n            dataType: 'native',\n            url: url,\n            xhrFields: {\n                responseType: 'arraybuffer'\n            },\n            success: callback\n        });\n    }\n}));\n"]}