{"version":3,"sources":["libs/jquery.complexify.js"],"names":["$","fn","extend","complexify","options","callback","str","charset","i","length","additionalComplexityForCharset","inBanlist","banMode","bannedPasswords","indexOf","toLowerCase","inArray","evaluateSecurity","password","this","val","complexity","valid","CHARSETS","Math","log","pow","strengthScaleFactor","minimumChars","MAX_COMPLEXITY","MIN_COMPLEXITY","defaults","window","COMPLEXIFY_BANLIST","isFunction","each","apply","bind","jQuery"],"mappings":"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","file":"../../scripts/libs/jquery.complexify.js","sourcesContent":["/*\n  http://github.com/danpalmer/jquery.complexify.js\n\n  This code is distributed under the WTFPL v2:\n*/\n(function ($) {\n\n  $.fn.extend({\n    complexify: function(options, callback) {\n\n      var MIN_COMPLEXITY = 49; // 12 chars with Upper, Lower and Number\n      var MAX_COMPLEXITY = 120; //  25 chars, all charsets\n      var CHARSETS = [\n        // Commonly Used\n        ////////////////////\n        [0x0020, 0x0020], // Space\n        [0x0030, 0x0039], // Numbers\n        [0x0041, 0x005A], // Uppercase\n        [0x0061, 0x007A], // Lowercase\n        [0x0021, 0x002F], // Punctuation\n        [0x003A, 0x0040], // Punctuation\n        [0x005B, 0x0060], // Punctuation\n        [0x007B, 0x007E], // Punctuation\n        // Everything Else\n        ////////////////////\n        [0x0080, 0x00FF], // Latin-1 Supplement\n        [0x0100, 0x017F], // Latin Extended-A\n        [0x0180, 0x024F], // Latin Extended-B\n        [0x0250, 0x02AF], // IPA Extensions\n        [0x02B0, 0x02FF], // Spacing Modifier Letters\n        [0x0300, 0x036F], // Combining Diacritical Marks\n        [0x0370, 0x03FF], // Greek\n        [0x0400, 0x04FF], // Cyrillic\n        [0x0530, 0x058F], // Armenian\n        [0x0590, 0x05FF], // Hebrew\n        [0x0600, 0x06FF], // Arabic\n        [0x0700, 0x074F], // Syriac\n        [0x0780, 0x07BF], // Thaana\n        [0x0900, 0x097F], // Devanagari\n        [0x0980, 0x09FF], // Bengali\n        [0x0A00, 0x0A7F], // Gurmukhi\n        [0x0A80, 0x0AFF], // Gujarati\n        [0x0B00, 0x0B7F], // Oriya\n        [0x0B80, 0x0BFF], // Tamil\n        [0x0C00, 0x0C7F], // Telugu\n        [0x0C80, 0x0CFF], // Kannada\n        [0x0D00, 0x0D7F], // Malayalam\n        [0x0D80, 0x0DFF], // Sinhala\n        [0x0E00, 0x0E7F], // Thai\n        [0x0E80, 0x0EFF], // Lao\n        [0x0F00, 0x0FFF], // Tibetan\n        [0x1000, 0x109F], // Myanmar\n        [0x10A0, 0x10FF], // Georgian\n        [0x1100, 0x11FF], // Hangul Jamo\n        [0x1200, 0x137F], // Ethiopic\n        [0x13A0, 0x13FF], // Cherokee\n        [0x1400, 0x167F], // Unified Canadian Aboriginal Syllabics\n        [0x1680, 0x169F], // Ogham\n        [0x16A0, 0x16FF], // Runic\n        [0x1780, 0x17FF], // Khmer\n        [0x1800, 0x18AF], // Mongolian\n        [0x1E00, 0x1EFF], // Latin Extended Additional\n        [0x1F00, 0x1FFF], // Greek Extended\n        [0x2000, 0x206F], // General Punctuation\n        [0x2070, 0x209F], // Superscripts and Subscripts\n        [0x20A0, 0x20CF], // Currency Symbols\n        [0x20D0, 0x20FF], // Combining Marks for Symbols\n        [0x2100, 0x214F], // Letterlike Symbols\n        [0x2150, 0x218F], // Number Forms\n        [0x2190, 0x21FF], // Arrows\n        [0x2200, 0x22FF], // Mathematical Operators\n        [0x2300, 0x23FF], // Miscellaneous Technical\n        [0x2400, 0x243F], // Control Pictures\n        [0x2440, 0x245F], // Optical Character Recognition\n        [0x2460, 0x24FF], // Enclosed Alphanumerics\n        [0x2500, 0x257F], // Box Drawing\n        [0x2580, 0x259F], // Block Elements\n        [0x25A0, 0x25FF], // Geometric Shapes\n        [0x2600, 0x26FF], // Miscellaneous Symbols\n        [0x2700, 0x27BF], // Dingbats\n        [0x2800, 0x28FF], // Braille Patterns\n        [0x2E80, 0x2EFF], // CJK Radicals Supplement\n        [0x2F00, 0x2FDF], // Kangxi Radicals\n        [0x2FF0, 0x2FFF], // Ideographic Description Characters\n        [0x3000, 0x303F], // CJK Symbols and Punctuation\n        [0x3040, 0x309F], // Hiragana\n        [0x30A0, 0x30FF], // Katakana\n        [0x3100, 0x312F], // Bopomofo\n        [0x3130, 0x318F], // Hangul Compatibility Jamo\n        [0x3190, 0x319F], // Kanbun\n        [0x31A0, 0x31BF], // Bopomofo Extended\n        [0x3200, 0x32FF], // Enclosed CJK Letters and Months\n        [0x3300, 0x33FF], // CJK Compatibility\n        [0x3400, 0x4DB5], // CJK Unified Ideographs Extension A\n        [0x4E00, 0x9FFF], // CJK Unified Ideographs\n        [0xA000, 0xA48F], // Yi Syllables\n        [0xA490, 0xA4CF], // Yi Radicals\n        [0xAC00, 0xD7A3], // Hangul Syllables\n        [0xD800, 0xDB7F], // High Surrogates\n        [0xDB80, 0xDBFF], // High Private Use Surrogates\n        [0xDC00, 0xDFFF], // Low Surrogates\n        [0xE000, 0xF8FF], // Private Use\n        [0xF900, 0xFAFF], // CJK Compatibility Ideographs\n        [0xFB00, 0xFB4F], // Alphabetic Presentation Forms\n        [0xFB50, 0xFDFF], // Arabic Presentation Forms-A\n        [0xFE20, 0xFE2F], // Combining Half Marks\n        [0xFE30, 0xFE4F], // CJK Compatibility Forms\n        [0xFE50, 0xFE6F], // Small Form Variants\n        [0xFE70, 0xFEFE], // Arabic Presentation Forms-B\n        [0xFEFF, 0xFEFF], // Specials\n        [0xFF00, 0xFFEF], // Halfwidth and Fullwidth Forms\n        [0xFFF0, 0xFFFD]  // Specials\n      ];\n\n      var defaults = {\n        minimumChars: 8,\n        strengthScaleFactor: 1,\n        bannedPasswords: window.COMPLEXIFY_BANLIST || [],\n        banMode: 'strict' // (strict|loose)\n      };\n\n      if($.isFunction(options) && !callback) {\n        callback = options;\n        options = {};\n      }\n\n      options = $.extend(defaults, options);\n\n      function additionalComplexityForCharset(str, charset) {\n        for (var i = str.length - 1; i >= 0; i--) {\n          if (charset[0] <= str.charCodeAt(i) && str.charCodeAt(i) <= charset[1]) {\n            return charset[1] - charset[0] + 1;\n          }\n        }\n        return 0;\n      }\n\n      function inBanlist(str) {\n        if (options.banMode === 'strict') {\n          for (var i = 0; i < options.bannedPasswords.length; i++) {\n            if (str.toLowerCase().indexOf(options.bannedPasswords[i].toLowerCase()) !== -1) {\n                return true;\n            }\n          }\n          return false;\n        } else {\n          return $.inArray(str, options.bannedPasswords) > -1 ? true : false;\n        }\n      }\n\n      function evaluateSecurity() {\n        var password = $(this).val();\n        var complexity = 0, valid = false;\n\n        // Reset complexity to 0 when banned password is found\n        if (!inBanlist(password)) {\n\n          // Add character complexity\n          for (var i = CHARSETS.length - 1; i >= 0; i--) {\n            complexity += additionalComplexityForCharset(password, CHARSETS[i]);\n          }\n\n        } else {\n          complexity = 1;\n        }\n\n        // Use natural log to produce linear scale\n        complexity = Math.log(Math.pow(complexity, password.length)) * (1/options.strengthScaleFactor);\n\n        valid = (complexity > MIN_COMPLEXITY && password.length >= options.minimumChars);\n\n        // Scale to percentage, so it can be used for a progress bar\n        complexity = (complexity / MAX_COMPLEXITY) * 100;\n        complexity = (complexity > 100) ? 100 : complexity;\n\n        callback.call(this, valid, complexity);\n      }\n\n      this.each(function () {\n      \tif($(this).val()) {\n          evaluateSecurity.apply(this);\n        }\n      });\n\n      return this.each(function () {\n        $(this).bind('keyup focus input propertychange mouseup', evaluateSecurity);\n      });\n\n    }\n  });\n\n})(jQuery);\n"]}