{"version":3,"sources":["layout/modal.js"],"names":["buttons","extra_buttons","$","Modal","options","this","$overlay","overlay","$dialog","dialog","$header","find","$body","$footer","$backdrop","backdrop","on","proxy","hide","extend","prototype","setContent","title","html","show","$buttons","each","name","value","append","closeButton","$extraButtons","text","body","addClass","removeClass","css","width","callback","height","outerHeight","parseInt","modal","fadeOut","children","remove","undefined","hide_modal","show_modal","init_fn","show_message","show_in_overlay","bind","unbind","url","scroll"],"mappings":"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","file":"../../scripts/layout/modal.js","sourcesContent":["import jQuery from \"jquery\";\n\n// ============================================================================\n//TODO: (the older version) unify with ui-modal (the newer version)\nvar $ = jQuery;\n\n// Modal dialog boxes\nvar Modal = function(options) {\n    this.$overlay = options.overlay;\n    this.$dialog = options.dialog;\n    this.$header = this.$dialog.find(\".modal-header\");\n    this.$body = this.$dialog.find(\".modal-body\");\n    this.$footer = this.$dialog.find(\".modal-footer\");\n    this.$backdrop = options.backdrop;\n    // Close button\n    this.$header.find(\".close\").on(\"click\", $.proxy(this.hide, this));\n};\n\n$.extend(Modal.prototype, {\n    setContent: function(options) {\n        this.$header.hide();\n        // Title\n        if (options.title) {\n            this.$header.find(\".title\").html(options.title);\n            this.$header.show();\n        }\n        if (options.closeButton) {\n            this.$header.find(\".close\").show();\n            this.$header.show();\n        } else {\n            this.$header.find(\".close\").hide();\n        }\n        // Buttons\n        this.$footer.hide();\n        var $buttons = this.$footer.find(\".buttons\").html(\"\");\n        if (options.buttons) {\n            $.each(options.buttons, (name, value) => {\n                $buttons\n                    .append(\n                        $(\"<button></button> \")\n                            .text(name)\n                            .click(value)\n                    )\n                    .append(\" \");\n            });\n            this.$footer.show();\n        }\n        var $extraButtons = this.$footer.find(\".extra_buttons\").html(\"\");\n        if (options.extra_buttons) {\n            $.each(options.extra_buttons, (name, value) => {\n                $extraButtons\n                    .append(\n                        $(\"<button></button>\")\n                            .text(name)\n                            .click(value)\n                    )\n                    .append(\" \");\n            });\n            this.$footer.show();\n        }\n        // Body\n        var body = options.body;\n        if (body == \"progress\") {\n            body = $(\n                \"<div class='progress progress-striped active'><div class='progress-bar' style='width: 100%'></div></div>\"\n            );\n        }\n        this.$body.html(body);\n    },\n    show: function(options, callback) {\n        if (!this.$dialog.is(\":visible\")) {\n            if (options.backdrop) {\n                this.$backdrop.addClass(\"in\");\n            } else {\n                this.$backdrop.removeClass(\"in\");\n            }\n            this.$overlay.show();\n            this.$dialog.show();\n            this.$overlay.addClass(\"in\");\n            // Fix min-width so that modal cannot shrink considerably if new content is loaded.\n            this.$body.css(\"min-width\", this.$body.width());\n            // Set max-height so that modal does not exceed window size and is in middle of page.\n            // TODO: this could perhaps be handled better using CSS.\n            this.$body.css(\n                \"max-height\",\n                $(window).height() -\n                    this.$footer.outerHeight() -\n                    this.$header.outerHeight() -\n                    parseInt(this.$dialog.css(\"padding-top\"), 10) -\n                    parseInt(this.$dialog.css(\"padding-bottom\"), 10)\n            );\n        }\n        // Callback on init\n        if (callback) {\n            callback();\n        }\n    },\n    hide: function() {\n        var modal = this;\n        modal.$dialog.fadeOut(() => {\n            modal.$overlay.hide();\n            modal.$backdrop.removeClass(\"in\");\n            modal.$body.children().remove();\n            // Clear min-width to allow for modal to take size of new body.\n            modal.$body.css(\"min-width\", undefined);\n        });\n    }\n});\n\nvar modal;\n\n$(() => {\n    modal = new Modal({\n        overlay: $(\"#top-modal\"),\n        dialog: $(\"#top-modal-dialog\"),\n        backdrop: $(\"#top-modal-backdrop\")\n    });\n});\n\n// Backward compatibility\nfunction hide_modal() {\n    modal.hide();\n}\n\nfunction show_modal(title, body, buttons, extra_buttons, init_fn) {\n    modal.setContent({\n        title: title,\n        body: body,\n        buttons: buttons,\n        extra_buttons: extra_buttons\n    });\n    modal.show({ backdrop: true }, init_fn);\n}\n\nfunction show_message(title, body, buttons, extra_buttons, init_fn) {\n    modal.setContent({\n        title: title,\n        body: body,\n        buttons: buttons,\n        extra_buttons: extra_buttons\n    });\n    modal.show({ backdrop: false }, init_fn);\n}\n\nfunction show_in_overlay(options) {\n    var width = options.width || \"600\";\n    var height = options.height || \"400\";\n    var scroll = options.scroll || \"auto\";\n    $(\"#overlay-background\").bind(\"click.overlay\", () => {\n        hide_modal();\n        $(\"#overlay-background\").unbind(\"click.overlay\");\n    });\n    modal.setContent({\n        closeButton: true,\n        title: \"&nbsp;\",\n        body: $(\n            `<div style='margin: -5px;'><iframe style='margin: 0; padding: 0;' src='${options.url}' width='${width}' height='${height}' scrolling='${scroll}' frameborder='0'></iframe></div>`\n        )\n    });\n    modal.show({ backdrop: true });\n}\n\n// ============================================================================\nexport default {\n    Modal: Modal,\n    hide_modal: hide_modal,\n    show_modal: show_modal,\n    show_message: show_message,\n    show_in_overlay: show_in_overlay\n};\n"]}