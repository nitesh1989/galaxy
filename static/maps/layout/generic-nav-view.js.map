{"version":3,"sources":["layout/generic-nav-view.js"],"names":["GenericNavView","Backbone","View","extend","initialize","this","modal","makeModalIframe","e","$el_chat_modal_header","iframe_template","window","Galaxy","config","communication_server_host","communication_server_port","query_string","escape","user","attributes","username","persistent_communication_rooms","$","length","_uiModal2","default","body","frame_height","height","width","closing_events","title_separator","cls","class_names","removeAttr","append","addClass","$el_chat_modal_body","hasClass","remove","removeClass","click","attr","css","frame_width","render","id","icon","visible","self","onclick"],"mappings":"sMAEIA,EAAiBC,SAASC,KAAKC,QAC/BC,WAAY,WACRC,KAAKC,MAAQ,MAIjBC,gBAAiB,SAASC,GAEtB,IAHJC,EAAA,KACAF,EAAiB,KAEbG,EAAAA,+DAAWC,OAAOC,OAAOC,OAAOC,0BAS5B,IAPOH,OAAOC,OAAOC,OAAOE,2BARhCC,aASeC,OAAON,OAAOC,OAAOM,KAAKC,WAAWC,UATpD,mCAFaH,OAAqBN,OAAAC,OAAAC,OAAAQ,kCAQlC,eAgEQC,OAvCJA,EAAE,eAAeC,OAAS,GAZ9BD,EAAA,eAAIZ,SAgBJV,EAAeM,MAAQ,IAAIkB,EAAAC,QAAMvB,MATjCwB,KAAIC,EACJC,OAdIZ,IAeJa,MADkB,IAYdC,gBAAgB,EATpBC,iBAAA,EACAC,IAhBI,wBAoBJhC,EAAAA,MAAeM,OACXoB,EAAMhB,EAAAA,6BACNkB,EAAQD,EAAAA,2BAERG,EAAAA,SAJkC,qBAKlCC,EAAAA,SAAiB,qBACjBC,EAAKC,KAAAA,MAAAA,SAN6BxB,EAAtCyB,WAAA,6BAkBAzB,EAAsB0B,OA5CtB,uPAoCAnC,EAAAA,gBAAAA,MAAA,SAAAQ,GACAC,EAAAA,eAAAA,IAAAA,UAA0B,UAG1BA,EAAAA,0BAAsB2B,MAAtB,SAAA5B,GACA6B,EAAAA,0BAA6BC,SAAA,cAC7B7B,EAAAA,6BAAiC8B,MAAjC,UACA9B,EAAAA,2BAAiCmB,OAAA,SACjCnB,EAAAA,0BACA+B,YAAA,aACEJ,SAAgBK,eACdnB,EAAE,0BAAmBoB,KAAW,QAAhC,YADJpB,EAAA,0BAAAqB,IAAA,cAAA,WAIErB,EAAA,6BAAgCO,MAAAe,SAC9BtB,EAAA,2BAAMM,OAA0BU,SAC5BhB,EAAAA,0BACAA,YAAE,eACFA,SAAE,aAGFA,EAAAA,0BAAEoB,KAA0BA,QAAK,YACjCpB,EAAAA,0BAAEqB,IAA0BA,cAAI,YAGhCrB,MAMHuB,OAAA,WAUDC,OAAAA,GAAI,mBALZC,KAAA,eACAF,QAAQ,cACJG,SAAIC,EACJC,QAzBA7C,KAyBcE,+BACJP,eAAVA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["/** Real-time Communication feature **/\nimport Modal from \"mvc/ui/ui-modal\";\nvar GenericNavView = Backbone.View.extend({\n    initialize: function() {\n        this.modal = null;\n    },\n\n    /** makes bootstrap modal and iframe inside it */\n    makeModalIframe: function(e) {\n        // make modal\n        var host = window.Galaxy.config.communication_server_host;\n\n        var port = window.Galaxy.config.communication_server_port;\n        var username = escape(window.Galaxy.user.attributes.username);\n\n        var persistent_communication_rooms = escape(window.Galaxy.config.persistent_communication_rooms);\n\n        var query_string = `?username=${username}&persistent_communication_rooms=${persistent_communication_rooms}`;\n\n        var src = `${host}:${port}${query_string}`;\n        var $el_chat_modal_header = null;\n        var $el_chat_modal_body = null;\n\n        var iframe_template = `<iframe class=\"f-iframe fade in communication-iframe\" src=\"${src}\"> </iframe>`;\n\n        var header_template =\n            '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n            '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n            '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>';\n\n        var frame_height = 350;\n        var frame_width = 600;\n        var class_names = \"ui-modal chat-modal\";\n\n        // deletes the chat modal if already present and create one\n        if ($(\".chat-modal\").length > 0) {\n            $(\".chat-modal\").remove();\n        }\n        // creates a modal\n        GenericNavView.modal = new Modal.View({\n            body: iframe_template,\n            height: frame_height,\n            width: frame_width,\n            closing_events: true,\n            title_separator: false,\n            cls: class_names\n        });\n\n        // shows modal\n        GenericNavView.modal.show();\n        $el_chat_modal_header = $(\".chat-modal .modal-header\");\n        $el_chat_modal_body = $(\".chat-modal .modal-body\");\n        // adjusts the css of bootstrap modal for chat\n        $el_chat_modal_header.addClass(\"modal-header-body\");\n        $el_chat_modal_body.addClass(\"modal-header-body\");\n        $el_chat_modal_header.find(\"h4\").remove();\n        $el_chat_modal_header.removeAttr(\"min-height padding border\");\n        $el_chat_modal_header.append(header_template);\n        // click event of the close button for chat\n        $(\".close-modal\").click(e => {\n            $(\".chat-modal\").css(\"display\", \"none\");\n        });\n        // click event of expand and compress icon\n        $(\".expand-compress-modal\").click(e => {\n            if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                $(\".chat-modal .modal-body\").height(\"575px\");\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-expand\")\n                    .addClass(\"fa-compress\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n            } else {\n                $(\".chat-modal .modal-dialog\").width(`${frame_width}px`);\n                $(\".chat-modal .modal-body\").height(`${frame_height}px`);\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-compress\")\n                    .addClass(\"fa-expand\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n            }\n        });\n        return this;\n    },\n\n    /**renders the chat icon as a nav item*/\n    render: function() {\n        var self = this;\n        var navItem = {};\n        navItem = {\n            id: \"show-chat-online\",\n            icon: \"fa-comment-o\",\n            tooltip: \"Chat online\",\n            visible: false,\n            onclick: self.makeModalIframe\n        };\n        return navItem;\n    }\n});\n\nexport default {\n    GenericNavView: GenericNavView\n};\n"]}